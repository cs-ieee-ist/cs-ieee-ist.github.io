<html>
  <head>
    <link rel="stylesheet" type="text/css" href="css/template.css"></link>
    <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js?lang=c&amp;skin=desert"></script>

  </head>
  <body>

    <div id = "pageTop">
      <div id = "projectName"><center>PO</center></div>
      <p></p>

      <div id = "className"><center>Programação com Objectos</center></div>

    </div>

    <div id = "pageBody">

      <center><h1 id = "sub1" class = "Programação com Objectos">Singleton</h1></center>

      <b> Goal </b>
      <p> &bull; Ensure there is only one instance of the class </p>
      <p> &bull; Provide global access to it </p>

      <div style="margin-top: 2%">
        <b> UML </b>
        <center><img src="media/img/po/UML/UML - Implementation/Singleton.jpg" width="20%"></img></center>
      </div>

      <b> Implementation </b>

<pre class="prettyprint linenums">

public class Singleton {

      private static Singleton  _singleInstance;

      private Singleton() {}

      public static Singleton getInstance() {
            if (_singleInstance == null)
                 _singleInstance = new Singleton();
            return _singleInstance;
      }

      public void displayInfo() {
         System.out.println("Single instance of the class.");
      }
}

public class Test {

      public static void main(String args[]) {

          Singleton _singleton = Singleton.getInstance();
          _singleton.displayInfo();

          //Singleton _newSingleton = new Singleton();  The constructor is private so it can't be instantiated
      }
}

</pre>

<center><h1 id = "sub2" class = "Programação com Objectos">State</h1></center>

    <b> Goal </b>
    <p> &bullet; Allow an object to change its behavior when its internal state changes</p>

    <b> When to use </b>
    <p> &bullet; An object's behavior depends on its state, and it must change its behavior at run-time depending on that state </p>
    <p> &bullet; There's several conditional statements that depend on the object's state </p>

    <div style="margin-top: 2%">
        <b> UML </b>
        <center><img src="media/img/po/UML/UML - Implementation/State.jpg" width="40%"></img></center>
    </div>

    <b> Implementation </b>

    <pre class="prettyprint linenums">

import java.util.Scanner;  //Used for testing purposes

public interface SurveyState {
      void openSurvey();
      void closeSurvey();
      void getCurrentState();
}

public class Survey {
      public SurveyState _openedSurvey;
      public SurveyState _closedSurvey;
      public SurveyState _createdSurvey;
      public SurveyState _currentState;

      public Survey() {
          _openedSurvey = new OpenedSurveyState(this);
          _closedSurvey = new ClosedSurveyState(this);
          _createdSurvey = new CreatedSurveyState(this);
          _currentState = _createdSurvey;
      }
  
      public SurveyState getClosedSurveyState() { return _closedSurvey; }
      public SurveyState getOpenedSurveyState() { return _openedSurvey; }

      public void setSurveyState(SurveyState state) {
          _currentState = state;
      }

      public void openSurvey() {
          _currentState.openSurvey();
      }
  
      public void closeSurvey() {
          _currentState.closeSurvey();
      }

      public void getCurrentStateInfo() { _currentState.getCurrentState(); }
}

public class OpenedSurveyState implements SurveyState {
      public Survey _survey;

      public OpenedSurveyState(Survey survey) {
          _survey = survey;
      }
  
      public void openSurvey() {
          System.out.println("The survey is already open.");
      }
  
      public void closeSurvey() {
          System.out.println("The survey has been closed.");
          _survey.setSurveyState(_survey.getClosedSurveyState());
      }
  
      public void getCurrentState() { 
          System.out.println("The survey is currently open."); 
      }
}

public class CreatedSurveyState implements SurveyState {
      public Survey _survey;  

      CreatedSurveyState(Survey survey) {
          _survey = survey;
      }
      
      public void openSurvey() {
          _survey.setSurveyState(_survey.getOpenedSurveyState());
      }
      
      public void closeSurvey() {
          System.out.println("The survey hasn't been open yet.");
      }

      public void getCurrentState() { 
          System.out.println("The survey hasn't been open yet.");
      } 

}

public class ClosedSurveyState implements SurveyState {
      public Survey _survey;

      public ClosedSurveyState(Survey survey) {
          _survey = survey;
      }
  
      public void openSurvey() {
          System.out.println("The survey has been opened.");
          _survey.setSurveyState(_survey.getOpenedSurveyState());
      }
  
      public void closeSurvey() {
          System.out.println("The survey is already closed.");
      }

      public void getCurrentState() { 
          System.out.println("The survey is currently closed."); 
      }
}

public class Test {
      public static void main(String args[]) {

          Scanner _scanner = new Scanner(System.in);
          Survey _survey = new Survey();
          String _input;

          while (true) {
              printMenu();
              _input = _scanner.nextLine();
              switch (_input) {
                  case "1":
                      _survey.openSurvey();
                      break;
                  case "2":
                      _survey.closeSurvey();
                      break;
                  case "3":
                      _survey.getCurrentStateInfo();
                      break;
                  case "4":
                      System.exit(0);
                  default:
                      break;
              }
          }
      }

      public static void printMenu() {
          System.out.println("Choose an option." + "\n" + 
            "Press 1 to open the survey." + "\n" + 
            "Press 2 to close the survey." + "\n" +
            "Press 3 to check the survey state." + "\n" +
            "Press 4 to exit." + "\n");
      }
}
    </pre>

<center><h1 id = "sub3" class = "Programação com Objectos">Composite</h1></center>

    <b> Goal </b>
    <p> &bullet; Compose objects into tree structures to represent part-whole hierarchies</p>

    <b> When to use </b>
    <p> &bullet; Represent part-whole hierarchies of objects</p>
    <p> &bullet; Treat all objects in the composite structure uniformly</p>

    <b> Structure - Generalization </b>
    <center><img src="media/img/po/UML/UML - Generalization/Composite.png" width="40%"></img></center>
    
    <div style="margin-top: 2%">
        <b> UML </b>
        <center><img src="media/img/po/UML/UML - Implementation/Composite.jpg" width="40%"></img></center>
    </div>

    <b> Implementation </b>

    <pre class="prettyprint linenums lang="java">

import java.util.ArrayList;

interface AbstractFile {
    void displayInfo();
}

public class Directory implements AbstractFile {
      private String _name;
      private ArrayList&ltAbstractFile&gt _files;

      public Directory(String name) {
          _name = name;
          _files = new ArrayList&ltAbstractFile&gt();
      }

      public void add(AbstractFile file) {
          _files.add(file);
      }

      public void displayInfo() {
          System.out.println("\n\nThe directoy's name is: " + _name);

          for (AbstractFile file : _files)
              file.displayInfo();   
      }
}

public class Album implements AbstractFile {
      private String _name;
      private ArrayList&ltSong&gt _albumSongs;

      public Album(String name) {
          _name = name;
          _albumSongs = new ArrayList&ltSong&gt();
      }

      public void addSong(Song song) {
          _albumSongs.add(song);
      }

      public void displayInfo() {
          System.out.println("The album's name is: " + _name);

          for (Song song : _albumSongs)
              song.displayInfo();

          System.out.println("");
      }
}

public class Song implements AbstractFile {
      private String _name;

      public Song(String name) {
          _name = name;
      }

      public void displayInfo() {
          System.out.println("The song name is: " + _name);
      }
}

public class Test {

      public static void main(String args[]) {
          Directory music = new Directory("Music");
          Directory moreMusic = new Directory("More Music");
          Song song1 = new Song("crybaby");
          Song song2 = new Song("AOV");
          Song song3 = new Song("Killpop");
          Song song4 = new Song("Custer");
          Song song5 = new Song("The Devil in I");
          Song song6 = new Song("Unsainted");
          Song song7 = new Song("Another Brick In the Wall");
          Album album1 = new Album(".5: The Gray Chapter");

          album1.addSong(song2);
          album1.addSong(song3);
          album1.addSong(song4);
          album1.addSong(song5);

          music.add(album1);
          music.add(song1);
          music.add(song6);
          music.add(moreMusic);
          moreMusic.add(song7);

          music.displayInfo();
      }
}
    </pre>

    <center><h1 id = "sub4" class = "Programação com Objectos">Visitor</h1></center>

    <b> Goal </b>
    <p> &bullet; Represent an operation to be performed on the elements of an object structure without changing the original classes of those elements </p>

    <b> When to use </b>
    <p> &bullet; The classes defining the object structure rarely change, but you often want to define new operations over the structure </p>
    <p> &bullet; Many distinct and unrelated operations need to be performed on objects in an object structure, and you want to avoid "polluting" their classes with these operations </p>

    <b> Structure - Generalization </b>
    <center><img src="media/img/po/UML/UML - Generalization/Visitor.png" width="40%"></img></center>
    
    <div style="margin-top: 2%">
        <b> UML </b>
        <center><img  src="media/img/po/UML/UML - Implementation/Visitor.jpg" width="40%"></img></center>
    </div>

    <b> Implementation </b>

    <pre class="prettyprint linenums lang="java">

interface Element {
      void accept(Visitor visitor);
}

interface Visitor {
      void visitStudent(Student student);
      void visitTeacher(Teacher teacher);
}

public abstract class Person {
      private String _name;
      private int _age;

      public Person(String name, int age) {
          _name = name;
          _age = age;
      }

      public String getName() {
          return _name;
      }

      public int getAge() {
          return _age;
      }

      @Override
      public String toString() {
          return String.format("Name: " + getName() + " Age: " + getAge());
      }
}

public class Student extends Person implements Element {
      private int _id;
  
      public Student(String name, int age, int id) {
          super(name, age);
          _id = id;
      }

      public int getId() {
          return _id;
      }

      public void accept(Visitor visitor) {
          visitor.visitStudent(this);
      }
}

public class Teacher extends Person implements Element {
      private String _subject;

      public Teacher(String name, int age, String subject) {
          super(name, age);
          _subject = subject;
      }

      public String getSubject() {
          return _subject;
      }

      public void accept(Visitor visitor) {
          visitor.visitTeacher(this);
      }
}

public class InformationVisitor implements Visitor {

      public void visitStudent(Student student) {
          System.out.println("Student -> " + student.toString() + " id: " + student.getId());
      }

      public void visitTeacher(Teacher teacher) {
          System.out.println("Teacher -> " + teacher.toString() + " subject: " + teacher.getSubject());
      }
}

public class Test {

      public static void main(String args[]) {
          InformationVisitor visitor = new InformationVisitor();
          Student student = new Student("John", 21, 999);
          Teacher teacher = new Teacher("Josef", 37, "PO");

          student.accept(visitor);
          teacher.accept(visitor);
      }
}

</pre>

<center><h1 id = "sub5" class = "Programação com Objectos">Observer</h1></center>

    <b> Goal </b>
    <p> &bullet; Define a one-to-many dependency between objects so that when one object changes, all its dependents are notified and updated automatically </p>
    <br>

    <b> When to use </b>
    <p> &bullet; When a change to one object requires changing others, and the amount of objects is unknown </p>
    <p> &bullet; When an object should be able to notify other objects without knowing who these objects are </p>
    <br>

    <b> Structure - Generalization </b>
    <center><img src="media/img/po/UML/UML - Generalization/Observer.png" width="40%"></img></center>

    <br>
    <h3> Participants </h3>
    <h4> Subject </h4>
    <p> &bullet; Provides an interface for attaching and detaching Observer objects </p>
    <h4> Observer </h4>
    <p> &bullet; Provides an interface for objects that should be notified of changes in a subject </p>
    <h4> ConcreteSubject </h4>
    <p> &bullet; Sends a notification to its observers when changes occur </p>
    <p> &bullet; Implements the Subject's methods </p>
    <h4> ConcreteObserver </h4>
    <p> &bullet; Implements the Observer's update method </p>

    <div style="margin-top: 2%">
        <b> UML </b>
        <center><img  src="media/img/po/UML/UML - Implementation/Observer.jpg" width="40%"></img></center>
    </div>

    <b> Implementation </b>

    <pre class="prettyprint linenums lang="java">

import java.util.ArrayList;

interface Observer {
      public void update(String message);
}

interface Subject {
      public void register(Observer observer);
      public void unregister(Observer observer);
      public void notifyObserver();
}

public class Notification implements Subject {
      private ArrayList&ltObserver&gt _observers;
      private String _message;

      public Notification() {
          _observers = new ArrayList&ltObserver&gt();
      }

      public void register(Observer observer) {
          _observers.add(observer);
      }

      public void unregister(Observer observer) {
          _observers.remove(observer);
      }

      public void notifyObserver() {
          for (Observer observer: _observers)
              observer.update(_message);
      }

      public void addNotification(String notification) {
          _message = notification;
          notifyObserver();
      }
}

public class Student implements Observer {
      private ArrayList&ltString&gt _messages;
      private String _name;
  
      public Student(String name) {
          _name = name;
          _messages = new ArrayList&ltString&gt();
      }

      public String getName() {
          return _name;
      }

      public void displayMessages() {
          System.out.println(getName() + " has " + _messages.size() + " messages.");
          for (String message: _messages)
              System.out.println(message);
          System.out.println("");
      }

      public void update(String message) {
          _messages.add(message);
      }
}

public class Test {

      public static void main(String args[]) {
          Notification notification = new Notification();
          Student student1 = new Student("Student1");
          Student student2 = new Student("Student2");

          //student1 and student2 are registered to recieve notifications
          notification.register(student1);
          notification.register(student2);

          notification.addNotification("Message 1");

          //Both observers will get notified
          student1.displayMessages();
          student2.displayMessages();

          notification.unregister(student2);

          notification.addNotification("Message 2");

          //student2 won't get this last notification
          student1.displayMessages();
          student2.displayMessages();
      }
}

    </pre>

  </body>

</html>